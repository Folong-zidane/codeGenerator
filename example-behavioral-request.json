{
  "classDiagramContent": "classDiagram\n    class User {\n        +UUID id\n        +String username\n        +String email\n        +String password\n        +LocalDateTime createdAt\n        +LocalDateTime updatedAt\n        +validateEmail()\n        +hashPassword()\n    }\n    class UserProfile {\n        +UUID id\n        +UUID userId\n        +String firstName\n        +String lastName\n        +String phone\n        +LocalDateTime updatedAt\n    }\n    User \"1\" --> \"1\" UserProfile",
  "sequenceDiagramContent": "sequenceDiagram\n    participant Client\n    participant UserController\n    participant UserService\n    participant UserRepository\n    participant Database\n\n    %% User Registration Flow\n    Client->>+UserController: POST /api/users/register\n    Note over Client,UserController: User registration request\n    \n    UserController->>+UserService: createUser(userData)\n    Note over UserService: Validate user data\n    \n    alt Valid user data\n        UserService->>+UserRepository: save(user)\n        UserRepository->>+Database: INSERT INTO users\n        Database-->>-UserRepository: User created\n        UserRepository-->>-UserService: User entity\n        UserService-->>-UserController: Created user\n        UserController-->>-Client: 201 Created\n    else Invalid data\n        UserService-->>UserController: ValidationException\n        UserController-->>Client: 400 Bad Request\n    end\n\n    %% User Login Flow\n    Client->>+UserController: POST /api/users/login\n    UserController->>+UserService: authenticateUser(credentials)\n    \n    UserService->>+UserRepository: findByEmail(email)\n    UserRepository->>+Database: SELECT * FROM users WHERE email = ?\n    Database-->>-UserRepository: User data\n    UserRepository-->>-UserService: User entity\n    \n    opt User found\n        UserService->>UserService: validatePassword(password)\n        alt Password valid\n            UserService->>UserService: generateToken()\n            UserService-->>UserController: AuthToken\n            UserController-->>Client: 200 OK with token\n        else Password invalid\n            UserService-->>UserController: AuthenticationException\n            UserController-->>Client: 401 Unauthorized\n        end\n    end\n\n    %% Get User Profile\n    Client->>+UserController: GET /api/users/profile\n    Note over Client,UserController: With Authorization header\n    \n    UserController->>UserController: validateToken()\n    UserController->>+UserService: getUserProfile(userId)\n    UserService->>+UserRepository: findById(userId)\n    UserRepository->>+Database: SELECT * FROM users WHERE id = ?\n    Database-->>-UserRepository: User data\n    UserRepository-->>-UserService: User entity\n    UserService-->>-UserController: User profile\n    UserController-->>-Client: 200 OK with profile\n\n    %% Update User Profile\n    Client->>+UserController: PUT /api/users/profile\n    UserController->>+UserService: updateUserProfile(userId, profileData)\n    \n    loop Validate each field\n        UserService->>UserService: validateField(field, value)\n    end\n    \n    UserService->>+UserRepository: update(user)\n    UserRepository->>+Database: UPDATE users SET ... WHERE id = ?\n    Database-->>-UserRepository: Updated rows\n    UserRepository-->>-UserService: Updated user\n    UserService-->>-UserController: Updated profile\n    UserController-->>-Client: 200 OK\n\n    %% Delete User Account\n    Client->>+UserController: DELETE /api/users/account\n    UserController->>+UserService: deleteUserAccount(userId)\n    \n    critical Ensure data consistency\n        UserService->>+UserRepository: softDelete(userId)\n        UserRepository->>+Database: UPDATE users SET deleted_at = NOW()\n        Database-->>-UserRepository: Success\n        UserRepository-->>-UserService: Deleted user\n    option Database error\n        UserService->>UserService: rollbackTransaction()\n        UserService-->>UserController: DatabaseException\n        UserController-->>Client: 500 Internal Server Error\n    end\n    \n    UserService-->>-UserController: Account deleted\n    UserController-->>-Client: 204 No Content",
  "packageName": "com.example.usermanagement",
  "language": "java"
}